function M=MemoryTwoM(p, q);

M = [
[  p(1)*q(1),   p(1)*(1 - q(1)),   q(1)*(1 - p(1)),   (1 - p(1))*(1 - q(1)),         0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,   p(2)*q(3),   p(2)*(1 - q(3)),   q(3)*(1 - p(2)),   (1 - p(2))*(1 - q(3)),         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,   p(3)*q(2),   p(3)*(1 - q(2)),   q(2)*(1 - p(3)),   (1 - p(3))*(1 - q(2)),         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0,   p(4)*q(4),   p(4)*(1 - q(4)),   q(4)*(1 - p(4)),   (1 - p(4))*(1 - q(4))];
[  p(5)*q(9),   p(5)*(1 - q(9)),   q(9)*(1 - p(5)),   (1 - p(5))*(1 - q(9)),         0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,  p(6)*q(11),  p(6)*(1 - q(11)),  q(11)*(1 - p(6)),  (1 - p(6))*(1 - q(11)),         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,  p(7)*q(10),  p(7)*(1 - q(10)),  q(10)*(1 - p(7)),  (1 - p(7))*(1 - q(10)),         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0,  p(8)*q(12),  p(8)*(1 - q(12)),  q(12)*(1 - p(8)),  (1 - p(8))*(1 - q(12))];
[  p(9)*q(5),   p(9)*(1 - q(5)),   q(5)*(1 - p(9)),   (1 - p(9))*(1 - q(5)),         0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,  p(10)*q(7),  p(10)*(1 - q(7)),  q(7)*(1 - p(10)),  (1 - p(10))*(1 - q(7)),         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,  p(11)*q(6),  p(11)*(1 - q(6)),  q(6)*(1 - p(11)),  (1 - p(11))*(1 - q(6)),         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0,  p(12)*q(8),  p(12)*(1 - q(8)),  q(8)*(1 - p(12)),  (1 - p(12))*(1 - q(8))];
[p(13)*q(13), p(13)*(1 - q(13)), q(13)*(1 - p(13)), (1 - p(13))*(1 - q(13)),         0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0, p(14)*q(15), p(14)*(1 - q(15)), q(15)*(1 - p(14)), (1 - p(14))*(1 - q(15)),         0,               0,               0,                     0,         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0, p(15)*q(14), p(15)*(1 - q(14)), q(14)*(1 - p(15)), (1 - p(15))*(1 - q(14)),         0,               0,               0,                     0];
[        0,               0,               0,                     0,         0,               0,               0,                     0,         0,               0,               0,                     0, p(16)*q(16), p(16)*(1 - q(16)), q(16)*(1 - p(16)), (1 - p(16))*(1 - q(16))]];
end